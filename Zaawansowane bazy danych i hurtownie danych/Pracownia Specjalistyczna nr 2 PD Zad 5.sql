SELECT DISTINCT GT.STATE_NAME, PKG.F_PROFIT_BY_STATE_AND_YEAR(GT.STATE_NAME, 2011) AS PROFIT
FROM ORDER_TEMP OT
JOIN GEOGRAPHY_TEMP GT ON OT.GEOGRAPHY_ID = GT.GEOGRAPHY_ID
ORDER BY PROFIT DESC;